@echo off
setlocal EnableDelayedExpansion

rem BatchGotAdmin
:-------------------------------------
REM  --> Check for permissions
    IF "%PROCESSOR_ARCHITECTURE%" EQU "amd64" (
>nul 2>&1 "%SYSTEMROOT%\SysWOW64\cacls.exe" "%SYSTEMROOT%\SysWOW64\config\system"
) ELSE (
>nul 2>&1 "%SYSTEMROOT%\system32\cacls.exe" "%SYSTEMROOT%\system32\config\system"
)

REM --> If error flag set, we do not have admin.
if '%errorlevel%' NEQ '0' (
    @echo. & @echo. & @echo [1m[31m	No Administrative rights, Execute as Administrator[0m
	@echo  Exiting in 5 Seconds
	TIMEOUT -T 5 /nobreak >nul
    exit /b
) else ( goto gotAdmin )
	
:gotAdmin
cls
@echo [1m[31mMalware removing Tool[0m & @echo.
@echo. [33m
"%ProgramFiles%\Windows Defender\MpCmdRun.exe" -removedefinitions -dynamicsignatures
"%ProgramFiles%\Windows Defender\MpCmdRun.exe" -SignatureUpdate
"%ProgramFiles%\Windows Defender\MpCmdRun.exe" -Scan -ScanType 1
@echo. [0m
%systemroot%\System32\MRT.exe

@echo  [1m[32mDONE![0m
pause
exit /b
